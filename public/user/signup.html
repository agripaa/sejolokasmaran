<!DOCTYPE html>
<html lang="id">
  <head>
    <title>Sejoli Kasmaran - Daftar Akun</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
      name="description"
      content="Sejoli Kasmaran - Platform Edukasi dan Konsultasi untuk Calon Orang Tua"
    />
    <meta name="author" content="sejolikasmaran.com" />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/public/assets/imgs/logos/sejoli-kasmaran-logo.svg"
    />
    <!-- Vendor CSS -->
    <link rel="stylesheet" href="/public/assets/css/animate.min.css?v=2.0" />
    <link rel="stylesheet" href="/public/assets/css/slick.css?v=2.0" />
    <!-- Template CSS -->
    <link rel="stylesheet" href="/public/assets/css/tailwind-built.css?v=2.0" />
  </head>
  <body class="bg-white text-body font-body">
    <div class="main">
      <!--Header-->
      <header class="bg-transparent sticky-bar mt-4">
        <div class="container bg-transparent">
          <nav class="bg-transparent flex justify-between items-center py-3">
            <a
              class="text-3xl font-semibold leading-none"
              href="/public/index.html"
            >
              <img
                class="h-10"
                src="/public/assets/imgs/logos/sejoli-kasmaran-horizontal.svg"
                alt=""
              />
            </a>
            <ul class="hidden lg:flex lg:items-center lg:w-auto lg:space-x-12">
              <li class="group relative pt-4 pb-4">
                <a
                  href="/public/index.html"
                  class="text-sm font-semibold text-blueGray-600 hover:text-blueGray-500"
                  >Beranda</a
                >
              </li>
              <li class="pt-4 pb-4">
                <a
                  class="text-sm font-semibold text-blueGray-600 hover:text-blueGray-500"
                  href="/public/about.html"
                  >Tentang</a
                >
              </li>
              <li class="group relative pt-4 pb-4">
                <a
                  class="text-sm font-semibold text-blueGray-600 hover:text-blueGray-500"
                  href="/public/services.html"
                  >Layanan</a
                >
              </li>
              <li class="group relative pt-4 pb-4">
                <a
                  class="text-sm font-semibold text-blueGray-600 hover:text-blueGray-500"
                  href="/public/news/blog.html"
                  >Berita dan Artikel</a
                >
              </li>
              <li class="pt-4 pb-4">
                <a
                  class="text-sm font-semibold text-blueGray-600 hover:text-blueGray-500"
                  href="/public/contact.html"
                  >Kontak</a
                >
              </li>
            </ul>
            <div class="hidden lg:block" id="navbar-auth">
              <a class="btn-accent hover-up-2" href="/public/user/login.html">Masuk</a>
              <a class="btn-primary hover-up-2" href="/public/user/signup.html">Buat Akun</a>
            </div>
            
            <div class="lg:hidden">
              <button
                class="navbar-burger flex items-center py-2 px-3 text-blue-500 hover:text-blue-700 rounded border border-blue-200 hover:border-blue-300"
              >
                <svg
                  class="fill-current h-4 w-4"
                  viewbox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <title>Mobile menu</title>
                  <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path>
                </svg>
              </button>
            </div>
          </nav>
        </div>
      </header>

      <!--Mobile menu-->
      <div class="hidden navbar-menu relative z-50 transition duration-300">
        <div
          class="navbar-backdrop fixed inset-0 bg-blueGray-800 opacity-25"
        ></div>
        <nav
          class="fixed top-0 left-0 bottom-0 flex flex-col w-5/6 max-w-sm py-6 px-6 bg-white border-r overflow-y-auto transition duration-300"
        >
          <div class="flex items-center mb-8">
            <a
              class="mr-auto text-3xl font-semibold leading-none"
              href="/public/index.html"
            >
              <img
                class="h-10"
                src="/public/assets/imgs/logos/sejoli-kasmaran-horizontal.svg"
                alt=""
              />
            </a>
            <button class="navbar-close">
              <svg
                class="h-6 w-6 text-blueGray-400 cursor-pointer hover:text-blue-500"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewbox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                ></path>
              </svg>
            </button>
          </div>
          <div>
            <ul class="mobile-menu">
              <li class="mb-1 rounded-xl">
                <a
                  class="block p-4 text-sm text-blueGray-500 hover:bg-blue-50 hover:text-blue-500 rounded-xl"
                  href="/public/index.html"
                  >Beranda</a
                >
              </li>
              <li class="mb-1 rounded-xl">
                <a
                  class="block p-4 text-sm text-blueGray-500 hover:bg-blue-50 hover:text-blue-500 rounded-xl"
                  href="/public/about.html"
                  >Tentang</a
                >
              </li>
              <li class="mb-1 menu-item-has-children rounded-xl">
                <a
                  class="block p-4 text-sm text-blueGray-500 hover:bg-blue-50 hover:text-blue-500"
                  href="/public/services.html"
                  >Layanan</a
                >
              </li>
              <li class="mb-1 rounded-xl">
                <a
                  class="block p-4 text-sm text-blueGray-500 hover:bg-blue-50 hover:text-blue-500 rounded-xl"
                  href="/public/news/blog.html"
                  >Berita dan Artikel</a
                >
              </li>
              <li class="mb-1 rounded-xl">
                <a
                  class="block p-4 text-sm text-blueGray-500 hover:bg-blue-50 hover:text-blue-500 rounded-xl"
                  href="/public/contact.html"
                  >Kontak</a
                >
              </li>
            </ul>
            <div class="hidden lg:block" id="navbar-auth">
              <a class="btn-accent hover-up-2" href="/public/user/login.html">Masuk</a>
              <a class="btn-primary hover-up-2" href="/public/user/signup.html">Buat Akun</a>
            </div>
            
          </div>
          <div class="mt-auto">
            <p class="my-4 text-xs text-blueGray-400">
              <span>Kontak Kami!</span>
              <a
                class="text-blue-500 hover:text-blue-500 underline"
                href="mailto:kontak.sejolikasmaran@gmail.com"
                >kontak.sejolikasmaran@gmail.com</a
              >
            </p>
            <a
              class="inline-block px-1"
              href="https://www.instagram.com/sejolikasmaran"
            >
              <img src="/public/assets/imgs/icons/facebook-blue.svg" alt="" />
            </a>
            <a
              class="inline-block px-1"
              href="https://www.instagram.com/sejolikasmaran"
            >
              <img src="/public/assets/imgs/icons/twitter-blue.svg" alt="" />
            </a>
            <a
              class="inline-block px-1"
              href="https://www.instagram.com/sejolikasmaran"
            >
              <img src="/public/assets/imgs/icons/instagram-blue.svg" alt="" />
            </a>
          </div>
        </nav>
      </div>

      <section class="py-12 bg-blueGray-50 min-h-screen flex items-center justify-center">
        <div class="container">
          <div class="flex max-w-md mx-auto flex-col text-center">
            <form id="registerForm" class="mb-8 p-8 bg-white rounded shadow">
              <h4 class="mb-6 text-3xl">Buat Akun Baru</h4>
              <div class="mb-4">
                <input
                  id="username"
                  class="w-full py-4 px-4 text-xs placeholder-blueGray-400 font-semibold leading-none bg-blueGray-50 rounded border border-gray-200 outline-none"
                  type="text"
                  placeholder="Nama Pengguna"
                  required
                />
              </div>
              <div class="mb-4">
                <input
                  id="email"
                  class="w-full py-4 px-4 text-xs placeholder-blueGray-400 font-semibold leading-none bg-blueGray-50 rounded border border-gray-200 outline-none"
                  type="email"
                  placeholder="Email"
                  required
                />
              </div>
              <div class="mb-4">
                <input
                  id="password"
                  class="w-full py-4 px-4 text-xs placeholder-blueGray-400 font-semibold leading-none bg-blueGray-50 rounded border border-gray-200 outline-none"
                  type="password"
                  placeholder="Kata Sandi"
                  required
                />
              </div>
              <div class="mb-4">
                <input
                  id="confPassword"
                  class="w-full py-4 px-4 text-xs placeholder-blueGray-400 font-semibold leading-none bg-blueGray-50 rounded border border-gray-200 outline-none"
                  type="password"
                  placeholder="Konfirmasi Kata Sandi"
                  required
                />
              </div>
              <div class="mb-6">
                <select
                  id="relationTypes"
                  class="w-full py-4 px-4 text-xs font-semibold bg-blueGray-50 rounded border border-gray-200"
                  required
                >
                  <option value="">Pilih Hubungan</option>
                  <option value="1">Ibu</option>
                  <option value="2">Ayah</option>
                  <option value="3">Kerabat</option>
                </select>
              </div>
              <div class="float-left mb-8">
                <label class="inline-flex text-xs">
                  <input type="checkbox" class="form-checkbox" checked />
                  <span class="ml-2"
                    >Saya setuju dengan
                    <a class="underline hover:text-blueGray-500" href="#"
                      >Kebijakan Privasi</a
                    >
                    dan
                    <a class="underline hover:text-blueGray-500" href="#"
                      >Syarat Penggunaan</a
                    ></span
                  >
                </label>
              </div>

              <button
                class="transition duration-300 ease-in-out transform hover:-translate-y-1 block w-full p-4 text-center text-xs text-white font-semibold leading-none bg-blue-500 hover:bg-blue-700 rounded"
                type="submit"
              >
                Daftar Sekarang
              </button>
              <div class="w-full mt-12 mx-auto text-center">
                <p class="text-sm">
                  Sudah punya akun?
                  <a
                    class="inline-block text-xs text-blue-600 hover:text-blue-700 font-semibold"
                    href="login.html"
                    >Masuk di sini</a
                  >
                </p>
              </div>
            </form>
            <div>
              <p class="text-xs text-blueGray-400 text-center">
                <a class="underline hover:text-blueGray-500" href="#"
                  >Kebijakan Privasi</a
                >
                dan
                <a class="underline hover:text-blueGray-500" href="#"
                  >Syarat Penggunaan</a
                >
              </p>
            </div>
          </div>
        </div>
      </section>

      <!--Footer 2-->
      <section class="relative footer-2 border-t border-gray-100">
        <div
          class="hidden lg:block absolute inset-0 w-1/2 ml-auto bg-blueGray-50"
        ></div>
        <div class="container">
          <div class="relative flex flex-wrap -mx-4">
            <div
              class="w-full lg:w-1/2 pt-20 px-4 max-w-lg lg:max-w-full mx-auto lg:mx-0 text-center lg:text-left"
            >
              <a
                class="inline-block mx-auto lg:ml-0 text-3xl font-semibold leading-none wow animate__animated animate__fadeInUp animated"
                data-wow-delay=".1s"
                href="/public/index.html"
              >
                <img
                  class="h-10"
                  src="/public/assets/imgs/logos/sejoli-kasmaran-horizontal.svg"
                  alt=""
                />
              </a>
              <div class="mt-12 mb-16">
                <p
                  class="mb-4 text-xs text-blueGray-400 text-center lg:text-left wow animate__animated animate__fadeInUp animated"
                  data-wow-delay=".1s"
                >
                  Berlangganan dan tetap terhubung sepenuhnya dengan Sejoli
                  Kasmaran!
                </p>
                <div
                  class="flex flex-wrap lg:flex-nowrap items-center wow animate__animated animate__fadeInUp animated"
                  data-wow-delay=".3s"
                >
                  <div
                    class="flex w-full lg:w-2/3 mb-3 lg:mb-0 px-4 bg-blueGray-50 rounded"
                  >
                    <svg
                      class="h-6 w-6 my-auto"
                      xmlns="http://www.w3.org/2000/svg"
                      viewbox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"
                      ></path>
                      <path
                        d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"
                      ></path>
                    </svg>
                    <input
                      class="w-full py-4 pl-3 text-xs text-blueGray-400 bg-blueGray-50 outline-none"
                      type="text"
                      placeholder="Email"
                    />
                  </div>
                  <button
                    class="hover-up-2 w-full lg:w-auto py-4 px-8 lg:ml-6 text-xs text-white font-semibold leading-none bg-blue-400 hover:bg-blue-500 rounded"
                    type="submit"
                  >
                    Buat Akun
                  </button>
                </div>
              </div>
              <div
                class="hidden lg:block wow animate__animated animate__fadeInUp animated"
                data-wow-delay=".5s"
              >
                <p class="text-xs text-blueGray-400">
                  &copy; 2024. Sejoli Kasmaran .All rights reserved.
                </p>
                <div class="-mx-2 mt-4">
                  <a class="inline-block px-2" href="#">
                    <img
                      src="/public/assets/imgs/icons/facebook-blue.svg"
                      alt="https://www.instagram.com/sejolikasmaran"
                    />
                  </a>
                  <a class="inline-block px-2" href="#">
                    <img
                      src="/public/assets/imgs/icons/twitter-blue.svg"
                      alt="https://www.instagram.com/sejolikasmaran"
                    />
                  </a>
                  <a
                    class="inline-block px-2"
                    href="https://www.instagram.com/sejolikasmaran"
                  >
                    <img
                      src="/public/assets/imgs/icons/instagram-blue.svg"
                      alt=""
                    />
                  </a>
                </div>
              </div>
            </div>
            <div class="relative w-full lg:w-1/2 px-4 pt-40 lg:pl-12">
              <div class="flex flex-row flex-wrap justify-around mb-12">
                <div
                  class="w-1/2 lg:w-auto mb-12 wow animate__animated animate__fadeInUp animated"
                  data-wow-delay=".1s"
                >
                  <h5 class="mb-6 text-lg font-bold font-heading">Tentang</h5>
                  <ul class="space-y-3">
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/about.html"
                        >Tentang Kami</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/news/blog.html"
                        >Berita & Artikel</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services.html"
                        >Layanan</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/contact.html"
                        >Kontak</a
                      >
                    </li>
                  </ul>
                </div>
                <div
                  class="w-1/2 lg:w-auto mb-12 wow animate__animated animate__fadeInUp animated"
                  data-wow-delay=".3s"
                >
                  <h5 class="mb-6 text-lg font-bold font-heading">Fitur</h5>
                  <ul class="space-y-3">
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services/pregnancy-calculator/health-calculator.html"
                        >Kalkulator Prediksi Persalinan</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services/pregnancy-risk-score/pregnancy-risk.html"
                        >Skor Risiko Kehamilan</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services/body-mass-index-calculator/health-calculator-2.html"
                        >Kalkulator Indeks Masa Tubuh (IMT)</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services/live-chat/consultation-options.html"
                        >Live Chat</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services/pregnancy-journal/journal.html"
                        >Jurnal Kehamilanku</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services/study-corner.html"
                        >Pojok Belajar</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services/pregnant-women-community/coming-soon.html"
                        >Komunitas Ibu Hamil</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/services/online-prenatal-yoga/live-yoga-notification.html"
                        >Kelas Yoga & Relaksasi Prenatal Online</a
                      >
                    </li>
                  </ul>
                </div>
                <div
                  class="w-full lg:w-auto mb-4 wow animate__animated animate__fadeInUp animated"
                  data-wow-delay=".5s"
                >
                  <h5 class="mb-6 text-lg font-bold font-heading">Blog</h5>
                  <ul class="space-y-3">
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/news/blog.html"
                        >Artikel Kesehatan</a
                      >
                    </li>
                    <li>
                      <a
                        class="text-lg text-blueGray-400 hover:text-blueGray-500"
                        href="/public/news/blog.html"
                        >Ibu Hamil Berbagi Cerita</a
                      >
                    </li>
                  </ul>
                </div>
              </div>
              <div class="lg:hidden text-center">
                <p class="text-xs text-blueGray-400">
                  &copy; 2024. Sejoli Kasmaran. All rights reserved.
                </p>
                <div class="-mx-2 mt-4">
                  <a
                    class="inline-block px-2"
                    href="https://www.instagram.com/sejolikasmaran"
                  >
                    <img
                      src="/public/assets/imgs/icons/facebook-blue.svg"
                      alt=""
                    />
                  </a>
                  <a
                    class="inline-block px-2"
                    href="https://www.instagram.com/sejolikasmaran"
                  >
                    <img
                      src="/public/assets/imgs/icons/twitter-blue.svg"
                      alt=""
                    />
                  </a>
                  <a
                    class="inline-block px-2"
                    href="https://www.instagram.com/sejolikasmaran"
                  >
                    <img
                      src="/public/assets/imgs/icons/instagram-blue.svg"
                      alt=""
                    />
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
    <!-- End .main -->

    <!-- Preloader Start -->
    <div id="preloader-active">
      <div class="preloader flex-1 content-center">
        <div class="logo absolute inset-y-2/4 jump">
          <img
            src="/public/assets/imgs/logos/sejoli-kasmaran-preloader.svg"
            alt=""
          />
        </div>
      </div>
    </div>
    <!--Import Vendor Js-->
    <script src="/public/assets/js/vendor/modernizr-3.6.0.min.js"></script>
    <script src="/public/assets/js/vendor/jquery-3.6.0.min.js"></script>
    <script src="/public/assets/js/vendor/waypoints.js"></script>
    <script src="/public/assets/js/vendor/counterup.js"></script>
    <script src="/public/assets/js/vendor/slick.js"></script>
    <script src="/public/assets/js/vendor/wow.js"></script>
    <script src="/public/assets/js/vendor/scrollup.js"></script>
    <script src="/public/assets/js/vendor/smooth.js"></script>
    <script src="/public/assets/js/vendor/textType.js"></script>
    <script src="/public/assets/js/vendor/mobile-menu.js"></script>
    <script src="/public/assets/js/main.js?v=2.0"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        fetch('../config.json')
          .then((response) => response.json())
          .then(async (config) => {
            const apiBaseUrl = config.API_BASE_URL;
            const profilUrl = `${apiBaseUrl}/auth/profile`;
            const token = localStorage.getItem('token');

            const navbarAuth = document.getElementById('navbar-auth');

            try {
              const response = await fetch(profilUrl, {
                method: 'GET',
                headers: {
                  'Content-Type': 'application/json',
                  'Authorization': `${token}`,
                },
              });

              const result = await response.json();
              const username = result.result.username; 

              navbarAuth.innerHTML = `
                <a href="/public/user/profile.html" class="text-sm font-semibold text-blueGray-600 mr-4">Hello, ${username}!</a>
                <button class="btn-accent hover-up-2" id="logout">Keluar</button>
              `;

              document.getElementById('logout').addEventListener('click', () => {
                localStorage.removeItem('token');
                window.location.reload();
              });
            } catch (error) {
              console.error('Gagal mendapatkan profil:', error);
              navbarAuth.innerHTML = `
                <a class="btn-accent hover-up-2" href="/public/user/login.html">Masuk</a>
                <a class="btn-primary hover-up-2" href="/public/user/signup.html">Buat Akun</a>
              `;
            }
          })
          .catch((error) => console.error('Gagal memuat konfigurasi:', error));
      });

      document.getElementById('registerForm').addEventListener('submit', async (event) => {
        event.preventDefault();

        const username = document.getElementById('username').value;
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const confPassword = document.getElementById('confPassword').value;
        const relationTypes = document.getElementById('relationTypes').value;

        fetch('/public/config.json')
        .then(response => response.json())
        .then(async(config) => {
          const apiBaseUrl = config.API_BASE_URL;
          const registerUrl = `${apiBaseUrl}/auth/register`

          if (!username || !email || !password || !confPassword || !relationTypes) {
            alert('Semua kolom wajib diisi.');
            return;
          }

          // Helper function to set an item with timestamp in localStorage
          function setItemWithExpiry(key, value, expiryInMs) {
              const now = new Date();
              const item = {
                  value: value,
                  expiry: now.getTime() + expiryInMs, // Expiry time in milliseconds
              };
              localStorage.setItem(key, JSON.stringify(item));
          }

          // Helper function to get an item from localStorage and check expiry
          function getItemWithExpiry(key) {
              const itemStr = localStorage.getItem(key);
              if (!itemStr) {
                  return null;
              }
              const item = JSON.parse(itemStr);
              const now = new Date();
              if (now.getTime() > item.expiry) {
                  // If the item is expired, remove it from localStorage
                  localStorage.removeItem(key);
                  return null;
              }
              return item.value;
          }

          localStorage.setItem('userEmail', email); // Ganti dengan:
          setItemWithExpiry('userEmail', email, 2 * 60 * 1000); // 2 menit (120.000 ms)

          const payload = {
            username,
            email,
            password,
            confPassword,
            relation_types: relationTypes,
          };

          try {
            const response = await fetch(registerUrl, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(payload),
            });

            const result = await response.json();

            if (!response.ok) {
              alert(result.msg || 'Registrasi gagal.');
              return;
            }

            alert('Registrasi berhasil! Periksa email Anda untuk OTP.');
            window.location.href = '/public/user/otp.html';
          } catch (error) {
            console.error('Error:', error);
            alert('Terjadi kesalahan, silakan coba lagi.');
          }
        })
      });
    </script>
  </body>
</html>
